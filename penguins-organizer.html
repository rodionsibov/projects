<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Penguins Organizer (Fetch API Sandbox)</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css" integrity="sha256-46r060N2LrChLLb5zowXQ72/iKKNiw/lAmygmHExk/o=" crossorigin="anonymous" />
    <style>
      
    </style>


  </head>
  <body>
    <div class="container text-center mt-5">
      <h1 class="display-4">Penguins üêß Organizer</h1>
      <p class="lead">Fetch API Sandbox</p>
    </div>
    <div class="container" id="root">

      <form class="">
	    <input type="text" id="name" class="form-control mb-2 mr-sm-2" placeholder="name">
	    <input type="text" id="email" class="form-control mb-2 mr-sm-2" placeholder="email">
	    <input type="text" id="company" class="form-control mb-2 mr-sm-2" placeholder="company">
	    <input class="btn btn-primary mb-2" type="submit">

      </form>
      
      <div class="card mb-5">
	<div class="card-header">
	  <ul class="nav nav-tabs card-header-tabs">
	    <li class="nav-item">
              <a class="penguins nav-link active" href="#">Penguins</a>
	    </li>
	    <li class="nav-item">
              <a class="todos nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Todos</a>
	    </li>
	  </ul>
	</div>

	<!-- card body -->

      </div>


      
    </div>
    
    <script>
      // "https://jsonplaceholder.typicode.com/todos"
      // "https://jsonplaceholder.typicode.com/users"

      //penguin class
      class Penguin {
	  constructor(name, email, company) {
	      this.name = name;
	      this.email = email;
	      this.company = company;
	  }
      }

      //todo class
      class Todo {
	  constructor(title, complited) {
	      this.title = title;
	      this.complited = complited;
	  }
      }

      //UI class
      class UI {
	  static displayPenguins() {
	      const storedPenguins = Store.getPenguins()

		    fetch("https://jsonplaceholder.typicode.com/users")
		    .then(response => response.json())
		    .then(data => {

		  })

	      const penguins = storedPenguins
	      penguins.forEach(penguin => UI.addPenguinToList(penguin))  
	      
	  }

	  static addPenguinToList(penguin) {
	      const card = document.querySelector('.card')
	      const div = document.createElement('div')
	  
	      div.className = 'card-body'
	      div.innerHTML = `
      <h5 class="card-title"><a href="#">${penguin.name}</a></h5>
      <p class="card-text"><i class="fas fa-envelope"></i> ${penguin.email} <i class="fas fa-building"></i> ${penguin.company.name}
      <button class="btn btn-danger btn-sm delete float-right">X</button></p>
    <hr>
    `;
	  card.appendChild(div)
      }
	  
	  static deletePenguin(el) {
	      if (el.classList.contains('delete')){
		  el.parentElement.parentElement.remove()
	      }
	  }

	  static showAlert(message, className) {
	      const div = document.createElement('div')
	      div.className = `alert alert-${className}`
	      div.appendChild(document.createTextNode(message))
	      document.querySelector('#root').insertBefore(div, document.querySelector('form'))

	      //vanish in 3 seconds
	      setTimeout(() => {
		  document.querySelector('.alert').remove()
	      }, 3000)
	  }
	  
	  
	  static clearFields() {
	      document.querySelector('#name').value = ''
	      document.querySelector('#email').value = ''
	      document.querySelector('#company').value = ''
	  }


	  
	  static displayTodos() {
	      const storedTodos = [];
	      
	      fetch("https://jsonplaceholder.typicode.com/todos")
		  .then(res => res.json())
		  .then(data => {
		      storedTodos.push(...data)
		  })

	      const todos = storedTodos;
	      todos.forEach(todo => UI.addTodoToList(todo))
	  }

	  static addTodoToList(){
	  }
      }

      //store class

      class Store {
	  static getPenguins() {
	      let penguins;
	      if(localStorage.getItem('penguins') === null) {
		  penguins = []
	      } else {
		  penguins = JSON.parse(localStorage.getItem('penguins'))
	      }

	      return penguins
	  }

	  static addPenguin(penguin) {
	      const penguins = Store.getPenguins()
	      penguins.push(penguin)

	      localStorage.setItem('penguins', JSON.stringify(penguins))
	  }

	  static removePenguin(id) {
	      const penguins = Store.getPenguins()
	      penguins.forEach((penguin, index) => {
		  if (penguin.id === id) {
		      penguins.splice(index, 1)
		  }
	      })

	      localStorage.setItem('penguins', JSON.stringify(penguins))

	  }

      }
      
      //event display 
      document.addEventListener('DOMContentLoaded', UI.displayPenguins);

      //event add
      document.querySelector('input[type="submit"]').addEventListener('click', () => {

	  //prevent actual submit

	  //get form values
	  const name = document.querySelector('#name').value
	  const email = document.querySelector('#email').value
	  const company = document.querySelector('#company').value

	  //validate
	  if (name === '' || email === '' || company === '') {
	      UI.showAlert('Please fill in all fields', 'danger')	      
	  } else {

	      //instantiate penguin
	      const penguin = new Penguin(name, email, company)

	      //add penguin to UI
	      UI.addPenguinToList(penguin)

	      //add penguin to store
	      Store.addPenguin(penguin)

	      //show success message
	      UI.showAlert('Penguin Added', 'success')
	      //clear fields
	      UI.clearFields();
	  }

      })

      //event remove

      document.querySelector('.card').addEventListener('click', (e) => {

	  //remove from UI
	  UI.deletePenguin(e.target)

	  //remove from store
	  Store.removePenguin()
	  
	  //show success message
	  UI.showAlert('Penguin Removed', 'success')
      })




      </script>


  </body>
</html>
