<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Penguins Organizer (Fetch API Sandbox)</title>

    <style>

      
    </style>

  </head>
  <body>
    
    <input id="addItem" autofocus>
      <h1 id="users">Users</h1> 
      <a href=""><h1>Todos</h1> </a>


    <script>


      const urlTodos = "https://jsonplaceholder.typicode.com/todos"
      const urlUsers = "https://jsonplaceholder.typicode.com/users"

      model = {
	  items: []
      }
      
      view = {
	  render() {
//	      document.querySelector("#users").innerHTML = "";
	      
	      if (model.items.length !== 0) {
		  const users = document.querySelector("#users");

		  users.innerHTML = model.items.map(item => {
		      if (item.completed) {
			  return `
<div id="${item.id}" style="text-decoration: line-through; font-size: 0.7em; color: green" onclick="controller.completeItem(${item.id})">${item.text}</div>
`
		      } else {
			  return `
<div id="${item.id}" style="font-size: 0.7em; color: black" onclick="controller.completeItem(${item.id})">${item.text}</div>
`

		      }

		  }).join("");
		  
	      }
	  },

	  addItem(e) {
	      if (e.code === "Enter") {
		  const input = document.querySelector("#addItem");
		  if (input.value !== "") {
		      controller.addItem(input.value);
		      return false;
		  }
	      }
	  }

      }

      controller = {
	  state: {
	      
	  },
	  
	  init() {
	      view.render();
	  },

	  addItem(item, id) {
	      const listItem = {text: item, completed: false, id: id};
	      model.items.unshift(listItem);
	      document.querySelector("#addItem").value = "";
	      view.render();
	  },

	  completeItem(itemIndex) {
	      model.items[itemIndex-1].completed = !model.items[itemIndex-1].completed;
	      view.render();
	  },

	  deleteItem(itemIndex) {
	      model.items.splice(itemIndex, 1);
	      view.render();
	  },

	  async getUsers() {
	      const data = await (await fetch(urlUsers)).json();
	      data.forEach(el => this.addItem(el.name, el.id));
	  },
	  
	  async getTodos() {
	      const data = await (await fetch(urlTodos)).json();
	      console.log("todos:", data)

	  }
      }


      
      // Event Display 
      addEventListener('DOMContentLoaded', () => {
	  controller.init();
	  controller.getUsers();
	  controller.getTodos();
	  console.log(model.items)
      })

      document.querySelector("#addItem").addEventListener("keypress", (e) => {
	  view.addItem(e);
      })
      
    </script>
      </body>
</html>
